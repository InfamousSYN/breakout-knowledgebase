{"config":{"lang":["en"],"separator":"[\\s\\-\\.]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Home","text":"<p>Fast Search</p> <p>Use the search bar at the top or press / to quickly find shortcuts (e.g., <code>CTRL+O</code>) or specific applications (e.g., <code>Edge</code>).</p> <p>Welcome to the central repository for VDI and restricted environment breakout techniques. This site is designed for quick reference during penetration testing engagements.</p> <p>Remember breakout techniques are fairly common and trivial to find. Our advice should not to have clients stomp specific shortcuts or applications, rather demonstrate the ability to breakout as a means to justify strategic controls:</p> <ol> <li>Application Control</li> <li>Endpoint Detection &amp; Response (EDR)</li> <li>Network Segmentation</li> </ol> <p>If the threat actor can't use applications on the VDA other than published applications to lateral movement then that can reduce the blast radius of a breakout.</p>"},{"location":"applications/edge/","title":"Microsoft Edge","text":""},{"location":"applications/edge/#file-open-breakout-ctrl-o","title":"File Open Breakout { #ctrl-o }","text":"<p>Shortcut: <code>CTRL</code> + <code>O</code></p> <ol> <li>Open Edge.</li> <li>Press CTRL+O.</li> <li>In the file explorer address bar, type <code>powershell.exe</code> and hit Enter.</li> </ol>"},{"location":"applications/edge/#print-escape-ctrl-p","title":"Print Escape { #ctrl-p }","text":"<p>Shortcut: <code>CTRL</code> + <code>P</code></p> <ol> <li>Press CTRL+P.</li> <li>Change printer to Microsoft Print to PDF.</li> <li>Click Print to trigger a \"Save As\" window, granting File Explorer access.</li> </ol>"},{"location":"experiences/oobe/","title":"Windows Out of Box Experience (OOBE)","text":"<p>Permissions</p> <p>The OOBE runs in the context of the local <code>defaultuser0</code> account, which has <code>NT Authority\\SYSTEM</code> privileges.</p>"},{"location":"experiences/oobe/#task-manager-breakout-ctrlshiftesc","title":"Task Manager Breakout { #ctrl+shift+esc }","text":"<p>Shortcut: <code>CTRL</code> + <code>SHIFT</code> + <code>ESC</code></p> <ol> <li>Press CTRL+SHIFT+ESC.</li> </ol> <p>forced background</p> <p>The <code>taskmgr.exe</code> process will be opened behind the Microsoft Account which is forced to the foregound. This is best paired with the CMD ESCAPE technique to enable the <code>taskmgr.exe</code> to be pulled to the foregound.</p>"},{"location":"experiences/oobe/#cmd-escape-shiftfunctionf10","title":"CMD Escape { #shift+function+f10 }","text":"<p>Shortcut: <code>SHIFT</code> + <code>FUNCTION</code> + <code>F10</code></p> <ol> <li>Press SHIFT+FUNCTION+F10 to open a <code>cmd.exe</code> process.</li> </ol> <p>Note</p> <p>The <code>cmd.exe</code> will open in the foreground.</p>"},{"location":"experiences/oobe/#accessibility-breakout-accessibility","title":"Accessibility Breakout { #accessibility }","text":"<p>Shortcut: N/A</p> <ol> <li>Click the accesibility icon at the bottom of the OOBE window.</li> <li>Select the magnify feature.</li> <li>Press CTRL+R to open run dialogue box.</li> <li>Launch a <code>powershell.exe</code> process</li> </ol> <p>forced background</p> <p>The run dialogue box and subsequent <code>powershell.exe</code> process will be forced to the background. As long as either are the active window (ALT+TAB), the processes will accept keyboard strokes.</p> <p>Windows UAC split-token</p> <p>The <code>powershell.exe</code> process in Windows 11 be subject to the Windows 11 UAC split-token security feature.</p>"}]}